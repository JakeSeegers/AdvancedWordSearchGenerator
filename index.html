<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Word Search Generator</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #d32f2f;
            margin-bottom: 10px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .settings-section {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 8px;
            border: 2px solid #d32f2f;
            margin-bottom: 40px;
        }
        
        .settings-section h3 {
            color: #d32f2f;
            margin-top: 0;
            border-bottom: 2px solid #d32f2f;
            padding-bottom: 10px;
            font-size: 24px;
        }
        
        .settings-row {
            display: flex;
            gap: 40px;
            flex-wrap: wrap;
        }
        
        .settings-column {
            flex: 1;
            min-width: 300px;
        }
        
        .word-input-section {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        
        .word-input-section h4 {
            margin: 0 0 15px 0;
            color: white;
            font-size: 18px;
        }
        
        .setting-group {
            margin-bottom: 20px;
        }
        
        .setting-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 16px;
        }
        
        .slider {
            width: 100%;
            margin-bottom: 8px;
        }
        
        .setting-value {
            font-size: 14px;
            color: #666;
            background: #fff;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-weight: bold;
        }
        
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-family: 'Courier New', monospace;
            margin-bottom: 10px;
            min-height: 120px;
            resize: vertical;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        button {
            background: #d32f2f;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #b71c1c;
        }
        
        .generate-button {
            background: #28a745;
            font-size: 18px;
            padding: 15px 30px;
            margin: 20px auto;
            display: block;
        }
        
        .generate-button:hover {
            background: #218838;
        }
        
        /* PUZZLE SECTION */
        .puzzle-section {
            margin-top: 40px;
            padding-top: 40px;
            border-top: 4px solid #d32f2f;
        }
        
        .current-theme {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #e8f5e8;
            border: 2px solid #28a745;
            border-radius: 8px;
            color: #2e7d2e;
            font-weight: bold;
            font-size: 18px;
        }
        
        .puzzle-content {
            display: flex;
            gap: 30px;
            justify-content: center;
            align-items: flex-start; /* Align to top */
            flex-wrap: wrap;
        }
        
        .grid-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .grid {
            position: relative;
            background: #f8f8f8;
            border: 3px solid #333;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
            padding: 30px;
            box-sizing: border-box;
        }
        
        .cell {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 50%;
            background: rgba(255,255,255,0.7);
        }
        
        .cell:hover {
            background: rgba(227, 242, 253, 0.9);
            transform: rotate(0deg) scale(1.2);
            z-index: 10;
        }
        
        .cell.highlighted {
            background: rgba(255, 235, 59, 0.9) !important;
            color: #d32f2f;
            transform: rotate(0deg) scale(1.1);
            z-index: 5;
            border: 2px solid #ff9800;
        }
        
        .words-list {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 8px;
            border: 2px solid #333;
            max-width: 400px; /* Base size, will be scaled by JS */
            align-self: stretch; /* Make it same height as grid in flex container */
        }
        
        .words-list h3 {
            margin-top: 0;
            color: #d32f2f;
            border-bottom: 2px solid #d32f2f;
            padding-bottom: 8px;
            font-size: 20px; /* Base size, will be scaled by JS */
        }
        
        .word-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px; /* Base size, will be scaled by JS */
        }
        
        .word-item {
            background: #e0e0e0;
            padding: 4px 8px; /* Base size, will be scaled by JS */
            border-radius: 12px; /* Base size, will be scaled by JS */
            transition: all 0.3s;
            font-size: 12px; /* Base size, will be scaled by JS */
        }
        
        .word-item.found {
            background: #4caf50;
            color: white;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .stats {
            text-align: center;
            margin: 15px 0;
            color: #666;
            font-size: 16px;
        }
        
        .info-text {
            font-size: 12px;
            color: #856404;
            background: #fff3cd;
            padding: 10px;
            border-radius: 4px;
            margin-top: 8px;
        }
        
        .hidden-for-print {
            display: block;
        }
        
        .hidden-for-print.hide {
            display: none;
        }
        
        /* MODIFIED: PRINT STYLES */
        @media print {
            /* NEW: Defines page size and orientation */
            @page {
                size: landscape;
                margin: 0.5in;
            }

            body {
                margin: 0;
                padding: 0;
                background: white;
                font-size: 10pt;
            }
            
            .container {
                box-shadow: none;
                max-width: none;
                padding: 0;
                border: none;
            }
            
            .hidden-for-print, .settings-section, h1, .subtitle, .controls, button {
                display: none !important;
            }
            
            .puzzle-section {
                margin-top: 0;
                padding-top: 0;
                border-top: none;
            }
            
            .current-theme {
                background: none !important;
                color: black !important;
                border: none;
                border-bottom: 2px solid black;
                font-size: 18pt;
                text-align: left;
                padding: 0 0 10px 0;
                border-radius: 0;
            }
            
            #difficultyDisplay { display: none !important; }
            .stats { text-align: left; font-size: 10pt; }
            
            /* MODIFIED: Use flexbox for page layout */
            .puzzle-content {
                display: flex;
                flex-direction: row;
                gap: 0.5in;
                align-items: flex-start;
                page-break-inside: avoid;
                width: 100%;
            }
            
            /* MODIFIED: Grid container takes up proportional space */
            .grid-container {
                flex: 3; /* Grid takes more space */
            }
            
            /* MODIFIED: Make the grid responsive to the page size */
            .grid {
                width: 100% !important; /* Override JS inline style */
                height: auto !important; /* Override JS inline style */
                aspect-ratio: 1 / 1;    /* Keep it square */
                border: 2px solid black;
                margin: 0;
                padding: 10px;
            }
            
            .cell {
                background: white !important;
                color: black !important;
                transform: none !important;
                border-radius: 0 !important;
                opacity: 1 !important;
            }
            
            .cell.highlighted {
                background: #cccccc !important;
                border: 1px dotted black !important;
            }
            
            /* MODIFIED: Word list takes up proportional space */
            .words-list {
                flex: 1; /* Word list takes less space */
                border: 2px solid black;
                background: white !important;
                padding: 15px;
                align-self: stretch;
            }

            .words-list h3 {
                border-bottom: 1px solid black;
                font-size: 14pt; /* Fixed size for print heading */
            }
            
            .word-item, .word-item.found {
                background: none !important;
                color: black !important;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="hidden-for-print">üîç OFFLINE WORD SEARCH GENERATOR üîç</h1>
        <p class="subtitle hidden-for-print">Create custom word search puzzles with your own words - no internet required!</p>
        
        <div class="settings-section hidden-for-print" id="settingsSection">
            <h3>‚öôÔ∏è Settings & Word List</h3>
            
            <div class="settings-row">
                <div class="settings-column">
                    <div class="word-input-section">
                        <h4>üìù Your Word List</h4>
                        <input type="text" id="puzzleTitle" placeholder="Puzzle Title (e.g., 'Ocean Animals', 'Space Terms')" value="My Custom Puzzle">
                        <textarea id="wordInput" placeholder="Enter your words, one per line or separated by commas:
SHARK
WHALE
DOLPHIN
OCTOPUS
...or...
SHARK, WHALE, DOLPHIN, OCTOPUS">SHARK
WHALE
DOLPHIN
OCTOPUS
CORAL
REEF
FISH
CRAB
SEAL
STARFISH
JELLYFISH
SEAWEED
TURTLE
SHRIMP
OYSTER</textarea>
                        <div class="info-text">
                            üí° Tip: Enter 10-50 words for best results. Mix of short and long words works great!
                        </div>
                    </div>
                </div>
                
                <div class="settings-column">
                    <div class="setting-group">
                        <label>Difficulty Level:</label>
                        <input type="range" class="slider" id="difficultySlider" min="1" max="5" value="3">
                        <div class="setting-value" id="difficultyValue">Level 3: Medium</div>
                        <div style="font-size: 12px; color: #666; margin-top: 8px; line-height: 1.4;">
                            <strong>Level One:</strong> Arial only, 20√ó20, no wobble (5x Size)<br>
                            <strong>Level Two:</strong> + Times New Roman, 25√ó25 (4x Size)<br>
                            <strong>Level Three:</strong> + Courier New, 30√ó30 (3x Size)<br>
                            <strong>Level Four:</strong> + Comic Sans, 35√ó35 (2x Size)<br>
                            <strong>Level Five:</strong> + Papyrus, 40√ó40, max chaos (1x Size)
                        </div>
                    </div>
                    
                    <div class="setting-group" style="background: #f0f0f0; padding: 15px; border-radius: 8px; border: 1px solid #ddd;">
                        <label style="margin-bottom: 15px;">Current Settings:</label>
                        <div style="font-size: 14px; line-height: 1.8;">
                            <strong>Fonts:</strong> <span id="currentFonts">Arial, Times New Roman, Courier New</span><br>
                            <strong>Grid Size:</strong> <span id="currentGrid">30√ó30</span><br>
                            <strong>Wobble:</strong> <span id="currentWobble">8¬∞</span><br>
                            <strong>Decoy Words:</strong> <span id="currentDecoys">35</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="generate-button" onclick="generatePuzzle()">üîÑ Generate Word Search Puzzle</button>
        </div>
        
        <div class="puzzle-section" style="display: none;" id="puzzleSection">
            <div id="currentTheme" class="current-theme">My Custom Puzzle</div>
            <div id="difficultyDisplay" class="current-theme" style="background: #fff3cd; border-color: #ffc107; color: #856404;">Level Three: Medium</div>
            
            <div class="controls">
                <button id="revealBtn" onclick="toggleReveal()">Reveal All Words</button>
                <button onclick="toggleSettings()" style="background: #ff9800;">üìÑ Hide Settings for Print</button>
                <button onclick="window.print()" style="background: #6c757d;">üñ®Ô∏è Print Puzzle</button>
            </div>
            
            <div class="stats">
                <span id="foundCount">0</span> of <span id="totalWords">15</span> words found
                <br><small style="color: #d32f2f;">‚ö†Ô∏è Contains decoy words!</small>
            </div>
            
            <div class="puzzle-content">
                <div class="grid-container">
                    <div class="grid" id="wordGrid"></div>
                </div>
                
                <div class="words-list" id="wordsListContainer">
                    <h3>Find These Words:</h3>
                    <div class="word-list" id="wordsList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let GRID_SIZE = 30;
        let grid = [];
        let placedWords = [];
        let revealMode = false;
        let userWords = [];
        
        const difficultyFonts = {
            1: ['Arial'],
            2: ['Arial', 'Times New Roman'],
            3: ['Arial', 'Times New Roman', 'Courier New'],
            4: ['Arial', 'Times New Roman', 'Courier New', 'Comic Sans MS'],
            5: ['Arial', 'Times New Roman', 'Courier New', 'Comic Sans MS', 'Papyrus']
        };
        
        const difficultySettings = {
            1: { gridSize: 20, wobble: 0, decoys: 0, name: 'Very Easy', nameWord: 'Level One', scaleMultiplier: 5 },
            2: { gridSize: 25, wobble: 4, decoys: 15, name: 'Easy', nameWord: 'Level Two', scaleMultiplier: 4 },
            3: { gridSize: 30, wobble: 8, decoys: 35, name: 'Medium', nameWord: 'Level Three', scaleMultiplier: 3 },
            4: { gridSize: 35, wobble: 12, decoys: 70, name: 'Hard', nameWord: 'Level Four', scaleMultiplier: 2 },
            5: { gridSize: 40, wobble: 15, decoys: 100, name: 'Extreme', nameWord: 'Level Five', scaleMultiplier: 1 }
        };
        
        const directions = [
            [0, 1], [0, -1], [1, 0], [-1, 0],
            [1, 1], [-1, -1], [1, -1], [-1, 1]
        ];
        
        document.getElementById('difficultySlider').oninput = function() {
            const level = parseInt(this.value);
            updateDifficultyDisplay(level);
        }
        
        function updateDifficultyDisplay(level) {
            const settings = difficultySettings[level];
            const fonts = difficultyFonts[level];
            
            document.getElementById('difficultyValue').textContent = `${settings.nameWord}: ${settings.name}`;
            document.getElementById('currentFonts').textContent = fonts.join(', ');
            document.getElementById('currentGrid').textContent = `${settings.gridSize}√ó${settings.gridSize}`;
            document.getElementById('currentWobble').textContent = `${settings.wobble}¬∞`;
            document.getElementById('currentDecoys').textContent = settings.decoys;
        }
        
        function getSettings() {
            const difficulty = parseInt(document.getElementById('difficultySlider').value);
            const settings = difficultySettings[difficulty];
            
            return {
                difficulty: difficulty,
                wobble: settings.wobble,
                fonts: difficultyFonts[difficulty],
                gridSize: settings.gridSize,
                decoyCount: settings.decoys,
                opacityRange: 30,
                scaleMultiplier: settings.scaleMultiplier
            };
        }
        
        function parseWordList() {
            const input = document.getElementById('wordInput').value.trim();
            if (!input) {
                alert('Please enter some words first!');
                return [];
            }
            let words = input.split(/[\n,]+/).map(w => w.trim().toUpperCase()).filter(w => w.length > 0);
            words = [...new Set(words)];
            if (words.length < 5) {
                alert('Please enter at least 5 words!');
                return [];
            }
            if (words.length > 100) {
                alert('Too many words! Please enter 100 or fewer words.');
                return [];
            }
            return words;
        }
        
        function generateDecoyWords(realWords, count) {
            const decoys = [];
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            realWords.forEach(word => {
                if (decoys.length < count && word.length > 2) {
                    const randomPos = Math.floor(Math.random() * word.length);
                    const newLetter = alphabet[Math.floor(Math.random() * alphabet.length)];
                    const decoy = word.substring(0, randomPos) + newLetter + word.substring(randomPos + 1);
                    if (!realWords.includes(decoy) && !decoys.includes(decoy)) decoys.push(decoy);
                }
                if (decoys.length < count && word.length > 3) {
                    const decoy = word.slice(0, -1);
                    if (!realWords.includes(decoy) && !decoys.includes(decoy)) decoys.push(decoy);
                }
            });
            return decoys.slice(0, count);
        }
        
        function initializeGrid() {
            const settings = getSettings();
            GRID_SIZE = settings.gridSize;
            grid = [];
            for (let i = 0; i < GRID_SIZE; i++) {
                grid[i] = [];
                for (let j = 0; j < GRID_SIZE; j++) {
                    grid[i][j] = '';
                }
            }
        }
        
        function canPlaceWord(word, row, col, direction) {
            const [dr, dc] = direction;
            for (let i = 0; i < word.length; i++) {
                const newRow = row + i * dr;
                const newCol = col + i * dc;
                if (newRow < 0 || newRow >= GRID_SIZE || newCol < 0 || newCol >= GRID_SIZE) return false;
                if (grid[newRow][newCol] !== '' && grid[newRow][newCol] !== word[i]) return false;
            }
            return true;
        }
        
        function placeWord(word, row, col, direction, isRealWord = true) {
            const [dr, dc] = direction;
            const positions = [];
            for (let i = 0; i < word.length; i++) {
                const newRow = row + i * dr;
                const newCol = col + i * dc;
                grid[newRow][newCol] = word[i];
                positions.push([newRow, newCol]);
            }
            if (isRealWord) {
                placedWords.push({ word: word, positions: positions, found: false });
            }
        }
        
        function tryPlaceWord(word, isRealWord = true) {
            const maxAttempts = 500;
            for (let attempt = 0; attempt < maxAttempts; attempt++) {
                const direction = directions[Math.floor(Math.random() * directions.length)];
                const row = Math.floor(Math.random() * GRID_SIZE);
                const col = Math.floor(Math.random() * GRID_SIZE);
                if (canPlaceWord(word, row, col, direction)) {
                    placeWord(word, row, col, direction, isRealWord);
                    return true;
                }
            }
            return false;
        }
        
        function fillEmptySpaces() {
            const commonLetters = 'EARIOTNSHLRUDCYMFWGPBVKJXQZ';
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    if (grid[i][j] === '') {
                        const weightedIndex = Math.floor(Math.random() * Math.random() * commonLetters.length);
                        grid[i][j] = commonLetters[weightedIndex];
                    }
                }
            }
        }
        
        function generatePuzzle() {
            userWords = parseWordList();
            if (userWords.length === 0) return;
            const settings = getSettings();
            const maxRetries = 10;
            let retryCount = 0;
            while (retryCount < maxRetries) {
                initializeGrid();
                placedWords = [];
                const sortedWords = [...userWords].sort((a, b) => b.length - a.length);
                let successfulPlacements = 0;
                sortedWords.forEach(word => { if (tryPlaceWord(word, true)) successfulPlacements++; });
                if (successfulPlacements === sortedWords.length) {
                    const decoyWords = generateDecoyWords(sortedWords, settings.decoyCount);
                    decoyWords.forEach(decoy => tryPlaceWord(decoy, false));
                    break; 
                } else {
                    retryCount++;
                }
            }
            if (retryCount === maxRetries) {
                alert(`‚ö†Ô∏è Could only place ${placedWords.length}/${userWords.length} words after ${maxRetries} attempts. Try using a higher difficulty level for a larger grid.`);
            }
            fillEmptySpaces();
            renderGrid();
            renderWordList();
            updateStats();
            const title = document.getElementById('puzzleTitle').value.trim() || 'My Custom Puzzle';
            document.getElementById('currentTheme').textContent = title;
            const diffSettings = difficultySettings[settings.difficulty];
            document.getElementById('difficultyDisplay').textContent = `${diffSettings.nameWord}: ${diffSettings.name}`;
            document.getElementById('puzzleSection').style.display = 'block';
            document.getElementById('puzzleSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        function renderGrid() {
            const settings = getSettings();
            const gridElement = document.getElementById('wordGrid');
            gridElement.innerHTML = '';
            const BASE_CELL_SIZE = 18;
            const BASE_FONT_SIZE = 9;
            const scaledCellSize = BASE_CELL_SIZE * settings.scaleMultiplier;
            const totalGridPixelSize = (settings.gridSize * scaledCellSize);
            const padding = 30;
            gridElement.style.width = `${totalGridPixelSize + (padding * 2)}px`;
            gridElement.style.height = `${totalGridPixelSize + (padding * 2)}px`;
            const fonts = settings.fonts;
            for (let i = 0; i < GRID_SIZE; i++) {
                for (let j = 0; j < GRID_SIZE; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.textContent = grid[i][j];
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    const baseX = j * scaledCellSize;
                    const baseY = i * scaledCellSize;
                    const offsetX = (Math.random() - 0.5) * settings.wobble * settings.scaleMultiplier;
                    const offsetY = (Math.random() - 0.5) * settings.wobble * settings.scaleMultiplier;
                    const rotation = (Math.random() - 0.5) * settings.wobble;
                    const randomFont = fonts[Math.floor(Math.random() * fonts.length)];
                    const randomSize = (BASE_FONT_SIZE + Math.random() * 4) * settings.scaleMultiplier;
                    const randomWeight = Math.random() > 0.6 ? 'bold' : 'normal';
                    cell.style.width = `${scaledCellSize}px`;
                    cell.style.height = `${scaledCellSize}px`;
                    cell.style.left = `${baseX + offsetX}px`;
                    cell.style.top = `${baseY + offsetY}px`;
                    cell.style.transform = `rotate(${rotation}deg)`;
                    cell.style.fontFamily = randomFont;
                    cell.style.fontSize = `${randomSize}px`;
                    cell.style.fontWeight = randomWeight;
                    const minOpacity = (100 - settings.opacityRange) / 100;
                    cell.style.opacity = minOpacity + Math.random() * (1 - minOpacity);
                    const grayValue = Math.floor(20 + Math.random() * 40);
                    cell.style.color = `rgb(${grayValue}, ${grayValue}, ${grayValue})`;
                    gridElement.appendChild(cell);
                }
            }
        }
        
        // MODIFIED: This function now scales the word list elements
        function renderWordList() {
            const settings = getSettings();
            const container = document.getElementById('wordsList');
            const mainContainer = document.getElementById('wordsListContainer');
            container.innerHTML = '';

            // --- Define base sizes for the word list ---
            const BASE_FONT_SIZE = 12;
            const BASE_PADDING_Y = 4;
            const BASE_PADDING_X = 8;
            const BASE_RADIUS = 12;
            const BASE_GAP = 8;
            const BASE_H3_FONT_SIZE = 20;
            const BASE_MAX_WIDTH = 400;

            // --- Apply scaled styles to containers ---
            // Use Math.sqrt on multiplier to prevent it from getting too wide on screen
            mainContainer.style.maxWidth = `${BASE_MAX_WIDTH * Math.sqrt(settings.scaleMultiplier)}px`;
            mainContainer.querySelector('h3').style.fontSize = `${BASE_H3_FONT_SIZE * Math.sqrt(settings.scaleMultiplier)}px`;
            container.style.gap = `${BASE_GAP * settings.scaleMultiplier}px`;

            const placedWordStrings = placedWords.map(w => w.word);
            placedWordStrings.forEach(word => {
                const wordElement = document.createElement('div');
                wordElement.className = 'word-item';
                wordElement.textContent = word;
                wordElement.dataset.word = word;
                
                // --- Apply scaled styles to each word item ---
                wordElement.style.fontSize = `${BASE_FONT_SIZE * settings.scaleMultiplier}px`;
                wordElement.style.padding = `${BASE_PADDING_Y * settings.scaleMultiplier}px ${BASE_PADDING_X * settings.scaleMultiplier}px`;
                wordElement.style.borderRadius = `${BASE_RADIUS * settings.scaleMultiplier}px`;

                container.appendChild(wordElement);
            });
        }
        
        function toggleReveal() {
            revealMode = !revealMode;
            const btn = document.getElementById('revealBtn');
            if (revealMode) {
                btn.textContent = 'Hide Words';
                highlightAllWords();
            } else {
                btn.textContent = 'Reveal All Words';
                clearHighlights();
            }
        }
        
        function highlightAllWords() {
            clearHighlights();
            placedWords.forEach(wordObj => {
                wordObj.positions.forEach(([row, col]) => {
                    const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                    if (cell) cell.classList.add('highlighted');
                });
                const wordElement = document.querySelector(`[data-word="${wordObj.word}"]`);
                if (wordElement) wordElement.classList.add('found');
            });
            updateStats();
        }
        
        function clearHighlights() {
            document.querySelectorAll('.cell.highlighted').forEach(c => c.classList.remove('highlighted'));
            document.querySelectorAll('.word-item.found').forEach(i => i.classList.remove('found'));
            placedWords.forEach(wordObj => { wordObj.found = false; });
            updateStats();
        }
        
        function updateStats() {
            const foundCount = placedWords.filter(w => w.found).length;
            const totalWords = placedWords.length;
            document.getElementById('foundCount').textContent = revealMode ? totalWords : foundCount;
            document.getElementById('totalWords').textContent = totalWords;
        }
        
        function toggleSettings() {
            const elements = document.querySelectorAll('.hidden-for-print');
            const button = event.target;
            elements.forEach(el => el.classList.toggle('hide'));
            if (elements[0].classList.contains('hide')) {
                button.textContent = '‚öôÔ∏è Show Settings';
                button.style.background = '#28a745';
            } else {
                button.textContent = 'üìÑ Hide Settings for Print';
                button.style.background = '#ff9800';
            }
        }
        
        // Initialize difficulty display
        updateDifficultyDisplay(3);
    </script>
</body>
</html>
